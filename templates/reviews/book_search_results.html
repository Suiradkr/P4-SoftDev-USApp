{% extends 'base.html' %}

{% block content %}
  <h1>Book search results</h1>

  <form method="get" action="{% url 'reviews:book_search' %}">
    <input type="search" name="q" placeholder="Search books by title" value="{{ request.GET.q }}" />
    <button type="submit">Search</button>
  </form>

  {% if books %}
    <ul class="review-list">
      {% for book in books %}
        <li class="review-item">
          <div class="review-border">
            <a href="{% url 'reviews:book_detail' book.pk %}"><strong>{{ book.title }}</strong></a>
            <p>{{ book.description|truncatechars:200 }}</p>
            <p class="text-muted small">
              {% if book.avg_rating %}
                Average rating: {{ book.avg_rating|floatformat:1 }} {% if book.reviews_count %}({{ book.reviews_count }} reviews){% endif %}
              {% else %}
                No reviews yet
              {% endif %}
            </p>
          </div>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No books match your search.</p>
  {% endif %}

{% endblock %}
