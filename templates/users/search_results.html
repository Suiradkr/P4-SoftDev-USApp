{% extends 'base.html' %}

{% block content %}
  <h1>Find users to follow</h1>

  <form method="get" action="{% url 'users:search' %}">
    <input type="search" name="q" placeholder="Search users by name or username" value="{{ query }}" />
    <button type="submit">Search</button>
  </form>

  {% if results %}
    <ul>
      {% for u in results %}
        <li>
          <a href="{% url 'users:profile_detail' u.pk %}">{{ u.full_name }}</a> â€” {{ u.username }}
          {% if request.user.is_authenticated and request.user != u %}
            <form method="post" action="{% url 'users:follow' u.pk %}" style="display:inline;margin-left:0.5rem;">
              {% csrf_token %}
              <button type="submit">{% if u.pk in following_ids %}Unfollow{% else %}Follow{% endif %}</button>
            </form>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    {% if query %}
      <p>No users found for "{{ query }}".</p>
    {% endif %}
  {% endif %}

{% endblock %}
